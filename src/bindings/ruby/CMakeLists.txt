message(STATUS "Configuring ${RUBY_TARGET} target")

# Save original swig output dir
set(CMAKE_SWIG_OUTDIR ${CMAKE_SWIG_ROOT_OUTDIR}/ruby)
set(SWIG_LANGUAGE_DIR ${CMAKE_SWIG_ROOT_OUTDIR}/ruby)

set(RUBY_SWIG_INTERFACES ${CMAKE_CURRENT_LIST_DIR}/showtime_ruby.i)
set_source_files_properties(${RUBY_SWIG_INTERFACES} PROPERTIES 
	CPLUSPLUS ON
)

swig_add_library(${RUBY_TARGET} 
	LANGUAGE ruby 
	TYPE SHARED 
    OUTPUT_DIR ${SWIG_LANGUAGE_DIR}
    OUTFILE_DIR ${CMAKE_SWIG_OUTDIR}
    SOURCES ${RUBY_SWIG_INTERFACES}
)
set_target_properties(${RUBY_TARGET} PROPERTIES 
	LIBRARY_OUTPUT_DIRECTORY ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/ruby
	OUTPUT_NAME "showtime"
)

target_include_directories(${RUBY_TARGET} PUBLIC 
	${Showtime_INCLUDE_DIRS}
	${Showtime_COMPILED_INCLUDE_DIRS}
	${RUBY_INCLUDE_DIRS}
)

add_dependencies(${SWIG_MODULE_${RUBY_TARGET}_REAL_NAME} ${CLIENT_TARGET})
swig_link_libraries(${RUBY_TARGET} ${CLIENT_TARGET} ${RUBY_LIBRARY})
