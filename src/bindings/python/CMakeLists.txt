set(SHOWTIME_PYTHON_TARGET showtime_py)

set(PYTHON_INTERFACES
    py_showtime.i
)

SET_SOURCE_FILES_PROPERTIES(${PYTHON_INTERFACES} PROPERTIES CPLUSPLUS ON)

FIND_PACKAGE(PythonLibs 3.6 REQUIRED)
INCLUDE_DIRECTORIES(${PYTHON_INCLUDE_PATH} ${BASEPATH})
include (${SWIG_USE_FILE})

SWIG_ADD_LIBRARY(${SHOWTIME_PYTHON_TARGET} LANGUAGE python SOURCES ${PYTHON_INTERFACES} ${ZST_HEADERS})
SET(SHOWTIME_SWIG_MODULE ${SWIG_MODULE_${SHOWTIME_PYTHON_TARGET}_REAL_NAME})

set_target_properties(${SHOWTIME_SWIG_MODULE} PROPERTIES DEBUG_POSTFIX  "_d")

SWIG_LINK_LIBRARIES(${SHOWTIME_PYTHON_TARGET}
	${PROJECT_NAME}
	${ZeroMQ_LIBRARIES} 
	${PYTHON_LIBRARIES}
	${CZMQ_LIBRARIES}
	${MSGPACK_LIBRARIES}
)

execute_process(COMMAND python -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())" OUTPUT_VARIABLE PYTHON_SITE_PACKAGES OUTPUT_STRIP_TRAILING_WHITESPACE)
install(TARGETS ${SHOWTIME_SWIG_MODULE} DESTINATION ${PYTHON_SITE_PACKAGES}/showtime_py)
install(FILES ${CMAKE_BINARY_DIR}/src/bindings/python/showtime_py.py DESTINATION ${PYTHON_SITE_PACKAGES}/showtime_py)
